<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Binding Cells in SEJ - arrenbrecht.ch</title>
    <style type="text/css" media="screen">
        @import "../style.css";
	
    </style>
    <link rel="stylesheet" type="text/css" media="print" href="../printstyle.css" />
</head>
<body>
    <div class="all">
        <div class="nav">
            <p class="nav">
<a href="http://www.arrenbrecht.ch/">arrenbrecht.ch</a> &gt;
<a href="../index.htm">SEJ</a> &gt;
<a href="index.htm">Tutorial</a> &gt;

			</p>
        </div>
        <div class="title">
            <h1>
                Binding Cells in SEJ</h1>
        </div>
        
        
        <div class="content">
        
<p>Input and output cells of a computation defined through a spreadsheet are bound to methods of plain Java interfaces or classes.</p>

<h2>Inputs</h2>
<p>To bind spreadsheet cells to variable input values, you must have an interface or a class defining getters for your input values. This is typically a public static inner type, defined explicitly for this purpose:</p>
<p>[jc:sej.tutorials.BindingCells:---- Input]</p>
<p>In order for the interface to be accessible to the generated engine, it must be <tt>public</tt>. This is because the engine is not loaded by the same class loader as your own classes (read <a href="http://www.artima.com/insidejvm/ed2/security2.html">why this matters</a>).</p>
<p>This type you provide to the engine builder prior to using it:</p>
<p>[jc:sej.tutorials.BindingCells:---- setupBuilder; highlight -in-; strip -out-]</p>
<p>In the <a href="basics.htm">simple usage scenario</a>, SEJ did all the cell binding automatically for you. Now you want to get full control over binding. To do this, you access the loaded spreadsheet, and the so called <em>root section binder</em>. This interface controls the binding of cells for the entire spreadsheet (as opposed to contained <a href="#BindRepeatingSections">sections of variable extent</a>).</p>
<p>[jc:sej.tutorials.BindingCells:---- getBinder]</p>
<p>You then tell the binder which cells are input cells, and to which getter methods on your type to bind them:</p>
<p>[jc:sej.tutorials.BindingCells:---- bindPlainInputs]</p>

<h3>Parameters</h3>
<p>You can also bind to parametrized methods. The arguments to the method are, however, determined at compile-time of the engine. This is where the <tt>CallFrame</tt> comes into play:</p>
<p>[jc:sej.tutorials.BindingCells:---- bindParamInputs]</p>
<p>With the call frame, you can even chain calls. In this example, we do the equivalent of <tt>getName().length()</tt>, where <tt>getName()</tt> returns a <tt>String</tt>:</p>
<p>[jc:sej.tutorials.BindingCells:---- bindChainedInputs]</p>

<h2>Outputs</h2>
<p>Outputs that the spreadsheet computes are bound to methods of an interface or a dedicated abstract class you define. This type is implemented or subclassed by the generated computation engine, which overrides all methods bound to output cells so they perform the computation specified in the spreadsheet.</p>
<p>Your output type is typically a static inner type. In order for it to be accessible to the generated computation, it must be <tt>public</tt>.</p>
<p>[jc:sej.tutorials.BindingCells:---- Output]</p>
<p>Like the input type, you also provide to the engine builder prior to using it:</p>
<p>[jc:sej.tutorials.BindingCells:---- setupBuilder; highlight -out-; strip -in-]</p>
<p>Now that the type is in place, we can bind output cells to it:</p>
<p>[jc:sej.tutorials.BindingCells:---- bindPlainOutputs]</p>

<h3>Parameters</h3>
<p>Like inputs, you can also bind outputs to parametrized methods. This is explained in detail in the topic on <a href="bindbyname.htm">binding by name</a>.</p>

<h2>Defaults</h2>
<p>If you supply implementations for your output methods, they serve as defaults in case they are not bound to an output cell of the spreadsheet. This is mainly useful when outputs are bound generically (by cell name, for instance).</p>
<p>To access input values when computing default output values, you can define a constructor that takes the input type as its sole parameter. SEJ then automatically calls that constructor with the current inputs. You can also access other output values by calling their corresponding methods, of course.</p>
<p>[jc:sej.tutorials.BindingCells:---- OutputWithDefaults]</p>        </div>
        <div class="footer">
<p>Copyright &copy; 2006 Peter Arrenbrecht. All rights reserved.
<br/>Last updated on 05.07.2006.</p>        </div>
    </div>
</body>
</html>