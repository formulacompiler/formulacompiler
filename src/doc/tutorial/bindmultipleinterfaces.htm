<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Binding To Multiple Interfaces in SEJ - arrenbrecht.ch</title>
    <style type="text/css" media="screen">
        @import "../style.css";
	
    </style>
    <link rel="stylesheet" type="text/css" media="print" href="../printstyle.css" />
	<script type="text/javascript" src="../scripts.js"></script>
	
</head>
<body onload="body_loaded();">
    <div class="all">
        <div class="nav">
            <p class="nav">
<a href="http://www.arrenbrecht.ch/">arrenbrecht.ch</a> &gt;
<a href="../index.htm">SEJ</a> &gt;
<a href="index.htm">Tutorial</a> &gt;

			</p>
        </div>
        <div class="title">
            <h1>
                Binding To Multiple Interfaces in SEJ</h1>
        </div>
        
        
        <div class="content">
        
<p>SEJ allows you to set only a single interface to provide inputs to or obtain outputs from a computation. How can you work around this?</p>

<h5>Note</h5>
<p>The example code on this page, while syntactically checked, is not yet part of an automated test.</p><div class="toc">
<p id="pagetoc" hfrom="2" hto="3"><i>Table Of Contents missing - need to enable JavaScript?</i></p>
</div>

<h2>Inputs</h2>
<p>To feed information to a computation from various sources, each with its own interface, you need to define a wrapper that gives access to the source interfaces.</p>
<p>Consider these two source interfaces:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Inputs]</p>
<p>The wrapper is a class with accessor properties returning instances the two source interfaces:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Input]</p>
<p>You then bind cells to elements of a particular source interface by using a <em>call chain</em>. SEJ allows you to bind cells to the result of calling a chain of methods:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- bindInputs]</p>

<h5>Note</h5>
<p>SEJ does not support multiple input interfaces directly because this would add a part of the application logic to SEJ that does not need to be customizable by spreadsheets. Therefore, it is better to leave this logic outside of SEJ. This gives you full control over it and avoids adding more black box behaviour than necessary.</p>

<h2>Outputs</h2>
<p>Assume a computation in a sheet must supply output values for two different interfaces:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Outputs]</p>
<p>To achieve this, the simplest approach is to simply make your output class implement both of the target interfaces:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Output]</p>
<p>You can then use your computation's output with both targets. However, this only works if name clashes are acceptable, that is, <tt>OutputA.getResult()</tt> maps to the same spreadsheet cell as <tt>OutputB.getResult()</tt>.</p>

<h3>Disambiguation</h3>
<p>If this is not the case, you have to do a little more work. You define your output class as follows:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Output2]</p>
<p>Then, you define wrappers which implement the proper interfaces:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Output2A]</p>
<p>and</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Output2B]</p>

<h5>Note</h5>
<p>SEJ does not support the following idiom:</p>
<p>[jc:sej.tutorials.BindingToMultipleInterfaces:---- Output3]</p>
<p>as it did for inputs. This is because for outputs, it is SEJ's responsibility to implement this interface. It only supports the approach with the least black box magic.</p>        </div>
        <div class="footer">
<p>Copyright &copy; 2006 Peter Arrenbrecht. All rights reserved.</p>        </div>
    </div>
</body>
</html>