# Abacus Formula Compiler Spreadsheet Model Description v1.0
# WARNING: THIS FILE MUST NOT CONTAIN HARD TABS!
---

sheets:

- name: UHL
  rows:
  - cells:
    - const: "MatchConsts"
    - expr: =MATCH( MC_In, RC[2]:RC[6] )
      name: MC_Out
    - const: 15.0
      name: MC_In
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - const: "MatchInputs"
    - expr: =MATCH( MI_In, RC[2]:RC[6] )
      name: MI_Out
    - const: 15.0
      name: MI_In
    - const: 10.0
    - const: 15.0
      name: MI_In_1
    - const: 20.0
      name: MI_In_2
    - const: 25.0
    - const: 30.0
  - cells:
  - cells:
    - const: "IndexConsts"
    - expr: =INDEX( RC[2]:RC[6], 1.0, IC_In )
      name: IC_Out
    - const: 3.0
      name: IC_In
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - const: "IndexInputs"
    - expr: =INDEX( RC[2]:RC[6], 1.0, II_In )
      name: II_Out
    - const: 3.0
      name: II_In
    - const: 10.0
    - const: 15.0
      name: II_In_1
    - const: 20.0
      name: II_In_2
    - const: 25.0
    - const: 30.0
  - cells:
  - cells:
    - const: "LookupConsts"
    - expr: =LOOKUP( LC_In, RC[2]:RC[4], RC[5]:RC[7] )
      name: LC_Out
    - const: 2.0
      name: LC_In
    - const: 1.0
    - const: 2.0
    - const: 3.0
    - const: 11.0
    - const: 12.0
    - const: 13.0
  - cells:
    - const: "LookupInputs"
    - expr: =LOOKUP( LI_In, RC[2]:LI_In_2, RC[5]:LI_In_4 )
      name: LI_Out
    - const: 2.0
      name: LI_In
    - const: 1.0
    - const: 2.0
      name: LI_In_1
    - const: 3.0
      name: LI_In_2
    - const: 11.0
    - const: 12.0
      name: LI_In_3
    - const: 13.0
      name: LI_In_4
  - cells:
  - cells:
    - const: "IndexMatchConsts"
    - expr: =INDEX( RC[5]:RC[7], 1.0, MATCH( IMC_In, RC[2]:RC[4] ) )
      name: IMC_Out
    - const: 2.0
      name: IMC_In
    - const: 1.0
    - const: 2.0
    - const: 3.0
    - const: 11.0
    - const: 12.0
    - const: 13.0
  - cells:
  - cells:
    - const: "MultiMatchConsts"
    - expr: =MATCH( MMC_In_1, RC[2]:RC[6] )
      name: MMC_Out_1
    - const: 15.0
      name: MMC_In_1
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - null
    - expr: =MATCH( MMC_In_2, R[-1]C[2]:R[-1]C[6] )
      name: MMC_Out_2
    - const: 27.0
      name: MMC_In_2
  - cells:
    - const: "MultiIndexConsts"
    - expr: =INDEX( RC[2]:RC[6], 1.0, MIC_In_1 )
      name: MIC_Out_1
    - const: 2.0
      name: MIC_In_1
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - null
    - expr: =INDEX( R[-1]C[2]:R[-1]C[6], 1.0, MIC_In_2 )
      name: MIC_Out_2
    - const: 3.0
      name: MIC_In_2
  - cells:
    - const: "MultiLookupConsts"
    - expr: =LOOKUP( MLC_In_1, RC[2]:RC[4], RC[5]:RC[7] )
      name: MLC_Out_1
    - const: 2.0
      name: MLC_In_1
    - const: 1.0
    - const: 2.0
    - const: 3.0
    - const: 11.0
    - const: 12.0
    - const: 13.0
  - cells:
    - null
    - expr: =LOOKUP( MLC_In_2, R[-1]C[2]:R[-1]C[4], R[-1]C[5]:R[-1]C[7] )
      name: MLC_Out_2
    - const: 3.0
      name: MLC_In_2
  - cells:
  - cells:
    - const: "SubArrayConsts"
    - expr: =HLOOKUP( SAC_In_1, RC[2]:R[2]C[5], 2.0 )
      name: SAC_Out_1
    - const: 19.0
      name: SAC_In_1
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
  - cells:
    - null
    - expr: =HLOOKUP( SAC_In_1, R[-1]C[2]:R[1]C[5], 3.0 )
      name: SAC_Out_2
    - null
    - const: 11.0
    - const: 12.0
    - const: 13.0
    - const: 14.0
  - cells:
    - null
    - expr: =MATCH( SAC_In_1, R[-2]C[2]:R[-2]C[5] )
      name: SAC_Out_3
    - null
    - const: 21.0
    - const: 22.0
    - const: 23.0
    - const: 24.0
  - cells:
  - cells:
    - const: "HLookupInputs"
    - expr: =HLOOKUP( HLI_In, RC[2]:R[2]C[5], HLI_In_1 )
      name: HLI_Out_1
    - const: 19.0
      name: HLI_In
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 2.0
      name: HLI_In_1
  - cells:
    - null
    - expr: =HLOOKUP( HLI_In, R[-1]C[2]:R[1]C[5], HLI_In_2 )
      name: HLI_Out_2
    - null
    - const: 11.0
    - const: 12.0
    - const: 13.0
    - const: 14.0
    - const: 3.0
      name: HLI_In_2
  - cells:
    - null
    - null
    - null
    - const: 21.0
    - const: 22.0
    - const: 23.0
    - const: 24.0

names:
- name: HLookupInputs
  ref: HLI_Out_1:R25C8
- name: IndexConsts
  ref: IC_Out:R4C8
- name: IndexInputs
  ref: II_Out:R5C8
- name: IndexMatchConsts
  ref: IMC_Out:R10C9
- name: LookupConsts
  ref: LC_Out:R7C9
- name: MatchConsts
  ref: MC_Out:R1C8
- name: MatchInputs
  ref: MI_Out:R2C8
- name: MultiIndexConsts
  ref: MIC_Out_1:R15C8
- name: MultiLookupConsts
  ref: MLC_Out_1:R17C9
- name: MultiMatchConsts
  ref: MMC_Out_1:R13C8
- name: SubArrayConsts
  ref: SAC_Out_1:R21C7
