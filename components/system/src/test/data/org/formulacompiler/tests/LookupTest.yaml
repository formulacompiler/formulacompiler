# Abacus Formula Compiler Spreadsheet Model Description v1.0
# WARNING: THIS FILE MUST NOT CONTAIN HARD TABS!
---

sheets:

- name: UHL
  rows:
  - cells:
    - const: "MatchConsts"
    - expr: =MATCH( MC_IN, RC[2]:RC[6] )
      name: MC_OUT
    - const: 15.0
      name: MC_IN
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - const: "MatchInputs"
    - expr: =MATCH( MI_IN, RC[2]:RC[6] )
      name: MI_OUT
    - const: 15.0
      name: MI_IN
    - const: 10.0
    - const: 15.0
      name: MI_IN_1
    - const: 20.0
      name: MI_IN_2
    - const: 25.0
    - const: 30.0
  - cells:
  - cells:
    - const: "IndexConsts"
    - expr: =INDEX( RC[2]:RC[6], 1.0, IC_IN )
      name: IC_OUT
    - const: 3.0
      name: IC_IN
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - const: "IndexInputs"
    - expr: =INDEX( RC[2]:RC[6], 1.0, II_IN )
      name: II_OUT
    - const: 3.0
      name: II_IN
    - const: 10.0
    - const: 15.0
      name: II_IN_1
    - const: 20.0
      name: II_IN_2
    - const: 25.0
    - const: 30.0
  - cells:
  - cells:
    - const: "LookupConsts"
    - expr: =LOOKUP( LC_IN, RC[2]:RC[4], RC[5]:RC[7] )
      name: LC_OUT
    - const: 2.0
      name: LC_IN
    - const: 1.0
    - const: 2.0
    - const: 3.0
    - const: 11.0
    - const: 12.0
    - const: 13.0
  - cells:
    - const: "LookupInputs"
    - expr: =LOOKUP( LI_IN, RC[2]:LI_IN_2, RC[5]:LI_IN_4 )
      name: LI_OUT
    - const: 2.0
      name: LI_IN
    - const: 1.0
    - const: 2.0
      name: LI_IN_1
    - const: 3.0
      name: LI_IN_2
    - const: 11.0
    - const: 12.0
      name: LI_IN_3
    - const: 13.0
      name: LI_IN_4
  - cells:
  - cells:
    - const: "IndexMatchConsts"
    - expr: =INDEX( RC[5]:RC[7], 1.0, MATCH( IMC_IN, RC[2]:RC[4] ) )
      name: IMC_OUT
    - const: 2.0
      name: IMC_IN
    - const: 1.0
    - const: 2.0
    - const: 3.0
    - const: 11.0
    - const: 12.0
    - const: 13.0
  - cells:
  - cells:
    - const: "MultiMatchConsts"
    - expr: =MATCH( MMC_IN_1, RC[2]:RC[6] )
      name: MMC_OUT_1
    - const: 15.0
      name: MMC_IN_1
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - null
    - expr: =MATCH( MMC_IN_2, R[-1]C[2]:R[-1]C[6] )
      name: MMC_OUT_2
    - const: 27.0
      name: MMC_IN_2
  - cells:
    - const: "MultiIndexConsts"
    - expr: =INDEX( RC[2]:RC[6], 1.0, MIC_IN_1 )
      name: MIC_OUT_1
    - const: 2.0
      name: MIC_IN_1
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 30.0
  - cells:
    - null
    - expr: =INDEX( R[-1]C[2]:R[-1]C[6], 1.0, MIC_IN_2 )
      name: MIC_OUT_2
    - const: 3.0
      name: MIC_IN_2
  - cells:
    - const: "MultiLookupConsts"
    - expr: =LOOKUP( MLC_IN_1, RC[2]:RC[4], RC[5]:RC[7] )
      name: MLC_OUT_1
    - const: 2.0
      name: MLC_IN_1
    - const: 1.0
    - const: 2.0
    - const: 3.0
    - const: 11.0
    - const: 12.0
    - const: 13.0
  - cells:
    - null
    - expr: =LOOKUP( MLC_IN_2, R[-1]C[2]:R[-1]C[4], R[-1]C[5]:R[-1]C[7] )
      name: MLC_OUT_2
    - const: 3.0
      name: MLC_IN_2
  - cells:
  - cells:
    - const: "SubArrayConsts"
    - expr: =HLOOKUP( SAC_IN_1, RC[2]:R[2]C[5], 2.0 )
      name: SAC_OUT_1
    - const: 19.0
      name: SAC_IN_1
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
  - cells:
    - null
    - expr: =HLOOKUP( SAC_IN_1, R[-1]C[2]:R[1]C[5], 3.0 )
      name: SAC_OUT_2
    - null
    - const: 11.0
    - const: 12.0
    - const: 13.0
    - const: 14.0
  - cells:
    - null
    - expr: =MATCH( SAC_IN_1, R[-2]C[2]:R[-2]C[5] )
      name: SAC_OUT_3
    - null
    - const: 21.0
    - const: 22.0
    - const: 23.0
    - const: 24.0
  - cells:
  - cells:
    - const: "HLookupInputs"
    - expr: =HLOOKUP( HLI_IN, RC[2]:R[2]C[5], HLI_IN_1 )
      name: HLI_OUT_1
    - const: 19.0
      name: HLI_IN
    - const: 10.0
    - const: 15.0
    - const: 20.0
    - const: 25.0
    - const: 2.0
      name: HLI_IN_1
  - cells:
    - null
    - expr: =HLOOKUP( HLI_IN, R[-1]C[2]:R[1]C[5], HLI_IN_2 )
      name: HLI_OUT_2
    - null
    - const: 11.0
    - const: 12.0
    - const: 13.0
    - const: 14.0
    - const: 3.0
      name: HLI_IN_2
  - cells:
    - null
    - null
    - null
    - const: 21.0
    - const: 22.0
    - const: 23.0
    - const: 24.0

names:
- name: HLOOKUPINPUTS
  ref: HLI_OUT_1:R25C8
- name: INDEXCONSTS
  ref: IC_OUT:R4C8
- name: INDEXINPUTS
  ref: II_OUT:R5C8
- name: INDEXMATCHCONSTS
  ref: IMC_OUT:R10C9
- name: LOOKUPCONSTS
  ref: LC_OUT:R7C9
- name: MATCHCONSTS
  ref: MC_OUT:R1C8
- name: MATCHINPUTS
  ref: MI_OUT:R2C8
- name: MULTIINDEXCONSTS
  ref: MIC_OUT_1:R15C8
- name: MULTILOOKUPCONSTS
  ref: MLC_OUT_1:R17C9
- name: MULTIMATCHCONSTS
  ref: MMC_OUT_1:R13C8
- name: SUBARRAYCONSTS
  ref: SAC_OUT_1:R21C7
